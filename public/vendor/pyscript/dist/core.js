Promise.withResolvers||(Promise.withResolvers=function(){var e,t,n=new this((function(n,r){e=n,t=r}));return{resolve:e,reject:t,promise:n}});const e=(e,t=document)=>t.querySelector(e),t=(e,t=document)=>[...t.querySelectorAll(e)],n=(e,t=document)=>{const n=(new XPathEvaluator).createExpression(e).evaluate(t,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE),r=[];for(let e=0,{snapshotLength:t}=n;e<t;e++)r.push(n.snapshotItem(e));return r},r="object"==typeof self?self:globalThis,s=e=>((e,t)=>{const n=(t,n)=>(e.set(n,t),t),s=o=>{if(e.has(o))return e.get(o);const[a,i]=t[o];switch(a){case 0:case-1:return n(i,o);case 1:{const e=n([],o);for(const t of i)e.push(s(t));return e}case 2:{const e=n({},o);for(const[t,n]of i)e[s(t)]=s(n);return e}case 3:return n(new Date(i),o);case 4:{const{source:e,flags:t}=i;return n(new RegExp(e,t),o)}case 5:{const e=n(new Map,o);for(const[t,n]of i)e.set(s(t),s(n));return e}case 6:{const e=n(new Set,o);for(const t of i)e.add(s(t));return e}case 7:{const{name:e,message:t}=i;return n(new r[e](t),o)}case 8:return n(BigInt(i),o);case"BigInt":return n(Object(BigInt(i)),o)}return n(new r[a](i),o)};return s})(new Map,e)(0),o="",{toString:a}={},{keys:i}=Object,l=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const n=a.call(e).slice(8,-1);switch(n){case"Array":return[1,o];case"Object":return[2,o];case"Date":return[3,o];case"RegExp":return[4,o];case"Map":return[5,o];case"Set":return[6,o]}return n.includes("Array")?[1,n]:n.includes("Error")?[7,n]:[2,n]},c=([e,t])=>0===e&&("function"===t||"symbol"===t),u=(e,{json:t,lossy:n}={})=>{const r=[];return((e,t,n,r)=>{const s=(e,t)=>{const s=r.push(e)-1;return n.set(t,s),s},o=r=>{if(n.has(r))return n.get(r);let[a,u]=l(r);switch(a){case 0:{let t=r;switch(u){case"bigint":a=8,t=r.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);t=null;break;case"undefined":return s([-1],r)}return s([a,t],r)}case 1:{if(u)return s([u,[...r]],r);const e=[],t=s([a,e],r);for(const t of r)e.push(o(t));return t}case 2:{if(u)switch(u){case"BigInt":return s([u,r.toString()],r);case"Boolean":case"Number":case"String":return s([u,r.valueOf()],r)}if(t&&"toJSON"in r)return o(r.toJSON());const n=[],f=s([a,n],r);for(const t of i(r))!e&&c(l(r[t]))||n.push([o(t),o(r[t])]);return f}case 3:return s([a,r.toISOString()],r);case 4:{const{source:e,flags:t}=r;return s([a,{source:e,flags:t}],r)}case 5:{const t=[],n=s([a,t],r);for(const[n,s]of r)(e||!c(l(n))&&!c(l(s)))&&t.push([o(n),o(s)]);return n}case 6:{const t=[],n=s([a,t],r);for(const n of r)!e&&c(l(n))||t.push(o(n));return n}}const{message:f}=r;return s([a,{name:u,message:f}],r)};return o})(!(t||n),!!t,new Map,r)(e),r},{parse:f,stringify:p}=JSON,d={json:!0,lossy:!0};var m=Object.freeze({__proto__:null,parse:e=>s(f(e)),stringify:e=>p(u(e,d))});const y="3099687a-04a9-4406-a08e-fd1602cb2a81",h="M"+y,g="T"+y;var w=e=>({value:new Promise((t=>{let n=new Worker("data:application/javascript,onmessage%3D(%7Bdata%3Ab%7D)%3D%3E(Atomics.wait(b%2C0)%2CpostMessage(0))");n.onmessage=t,n.postMessage(e)}))})
/*! (c) Andrea Giammarchi - ISC */;const{Int32Array:_,Map:b,SharedArrayBuffer:v,Uint16Array:E}=globalThis,{BYTES_PER_ELEMENT:j}=_,{BYTES_PER_ELEMENT:k}=E,{isArray:S}=Array,{notify:A,wait:P,waitAsync:x}=Atomics,{fromCharCode:$}=String,R=(e,t)=>e?(x||w)(t,0):(P(t,0),{value:{then:e=>e()}}),T=new WeakSet,M=new WeakMap;let O=0;const N=(e,{parse:t,stringify:n,transform:r}=JSON)=>{if(!M.has(e)){const s=(t,...n)=>e.postMessage({[y]:n},{transfer:t});let o=!1;M.set(e,new Proxy(new b,{has:(e,t)=>"string"==typeof t&&!t.startsWith("_"),get:(n,a)=>"then"===a?null:(...n)=>{const i=O++;let l=new _(new v(j)),c=[];T.has(n.at(-1)||c)&&T.delete(c=n.pop()),s(c,i,l,a,r?n.map(r):n);const u=e!==globalThis;let f=0;return o&&u&&(f=setTimeout(console.warn,1e3,`ðŸ’€ðŸ”’ - Possible deadlock if proxy.${a}(...args) is awaited`)),R(u,l).value.then((()=>{clearTimeout(f);const e=l[0];if(!e)return;const n=k*e;return l=new _(new v(n+n%j)),s([],i,l),R(u,l).value.then((()=>t($(...new E(l.buffer).slice(0,e)))))}))},set(t,s,a){if(!t.size){const s=new b;e.addEventListener("message",(async e=>{const a=e.data?.[y];if(S(a)){e.stopImmediatePropagation();const[i,l,...c]=a;if(c.length){const[e,a]=c;if(!t.has(e))throw new Error(`Unsupported action: ${e}`);o=!0;try{const o=await t.get(e)(...a);if(void 0!==o){const e=n(r?r(o):o);s.set(i,e),l[0]=e.length}}finally{o=!1}}else{const e=s.get(i);s.delete(i);for(let t=new E(l.buffer),n=0;n<e.length;n++)t[n]=e.charCodeAt(n)}A(l,0)}}))}return!!t.set(s,a)}}))}return M.get(e)};N.transfer=(...e)=>(T.add(e),e);const W="object",I="function",C="number",F="string",L="undefined",B="symbol",{defineProperty:J,getOwnPropertyDescriptor:D,getPrototypeOf:H,isExtensible:U,ownKeys:q,preventExtensions:z,set:Y,setPrototypeOf:Q}=Reflect,{assign:X,create:K}=Object,G=H(Int8Array),V="isArray",Z=(e,t)=>{const{get:n,set:r,value:s}=e;return n&&(e.get=t(n)),r&&(e.set=t(r)),s&&(e.value=t(s)),e},ee=(e,t)=>[e,t],te=e=>t=>{const n=typeof t;switch(n){case W:if(null==t)return ee("null",t);if(t===globalThis)return ee(W,null);case I:return e(n,t);case"boolean":case C:case F:case L:case"bigint":return ee(n,t);case B:if(ne.has(t))return ee(n,ne.get(t))}throw new Error(`Unable to handle this ${n} type`)},ne=new Map(q(Symbol).filter((e=>typeof Symbol[e]===B)).map((e=>[Symbol[e],e]))),re=e=>{for(const[t,n]of ne)if(n===e)return t};function se(){return this}const oe="apply",ae="construct",ie="defineProperty",le="deleteProperty",ce="get",ue="getOwnPropertyDescriptor",fe="getPrototypeOf",pe="has",de="isExtensible",me="ownKeys",ye="preventExtensions",he="set",ge="setPrototypeOf",we="delete";var _e=((e,t)=>{const n=t&&new WeakMap;if(t){const{addEventListener:e}=EventTarget.prototype;J(EventTarget.prototype,"addEventListener",{value(t,r,...s){return s.at(0)?.invoke&&(n.has(this)||n.set(this,new Map),n.get(this).set(t,[].concat(s[0].invoke)),delete s[0].invoke),e.call(this,t,r,...s)}})}const r=t&&(e=>{const{currentTarget:t,target:r,type:s}=e;for(const o of n.get(t||r)?.get(s)||[])e[o]()});return(n,s,o,...a)=>{let i=0;const l=new Map,c=new Map,{[o]:u}=n,f=a.length?X(K(globalThis),...a):globalThis,p=te(((e,t)=>{if(!l.has(t)){let e;for(;c.has(e=i++););l.set(t,e),c.set(e,t)}return ee(e,l.get(t))})),d=new FinalizationRegistry((e=>{u(we,ee(F,e))})),m=([e,n])=>{switch(e){case W:if(null==n)return f;if(typeof n===C)return c.get(n);if(!(n instanceof G))for(const e in n)n[e]=m(n[e]);return n;case I:if(typeof n===F){if(!c.has(n)){const e=function(...e){return t&&e.at(0)instanceof Event&&r(...e),u(oe,ee(I,n),p(this),e.map(p))},s=new WeakRef(e);c.set(n,s),d.register(e,n,s)}return c.get(n).deref()}return c.get(n);case B:return re(n)}return n},y={[oe]:(e,t,n)=>p(e.apply(t,n)),[ae]:(e,t)=>p(new e(...t)),[ie]:(e,t,n)=>p(J(e,t,n)),[le]:(e,t)=>p(delete e[t]),[fe]:e=>p(H(e)),[ce]:(e,t)=>p(e[t]),[ue]:(e,t)=>{const n=D(e,t);return n?ee(W,Z(n,p)):ee(L,n)},[pe]:(e,t)=>p(t in e),[de]:e=>p(U(e)),[me]:e=>ee(W,q(e).map(p)),[ye]:e=>p(z(e)),[he]:(e,t,n)=>p(Y(e,t,n)),[ge]:(e,t)=>p(Q(e,t)),[we](e){l.delete(c.get(e)),c.delete(e)}};return n[s]=(e,t,...n)=>{switch(e){case oe:n[0]=m(n[0]),n[1]=n[1].map(m);break;case ae:n[0]=n[0].map(m);break;case ie:{const[e,t]=n;n[0]=m(e);const{get:r,set:s,value:o}=t;r&&(t.get=m(r)),s&&(t.set=m(s)),o&&(t.value=m(o));break}default:n=n.map(m)}return y[e](m(t),...n)},{proxy:n,[e.toLowerCase()]:f,[`is${e}Proxy`]:()=>!1}}})("Window",!0),be=(e=>{let t=0;const n=new Map,r=new Map,s=Symbol(),o=e=>typeof e===I?e():e,a=e=>typeof e===W&&!!e&&s in e,i=Array[V],l=te(((e,a)=>{if(s in a)return o(a[s]);if(e===I){if(!r.has(a)){let e;for(;r.has(e=String(t++)););n.set(a,e),r.set(e,a)}return ee(e,n.get(a))}if(!(a instanceof G))for(const e in a)a[e]=l(a[e]);return ee(e,a)}));return(t,c,u)=>{const{[c]:f}=t,p=new Map,d=new FinalizationRegistry((e=>{p.delete(e),f(we,l(e))})),m=e=>{const[t,n]=e;if(!p.has(n)){const r=t===I?se.bind(e):e,s=new Proxy(r,g),o=new WeakRef(s);p.set(n,o),d.register(s,n,o)}return p.get(n).deref()},y=e=>{const[t,n]=e;switch(t){case W:return null===n?globalThis:typeof n===C?m(e):n;case I:return typeof n===F?r.get(n):m(e);case B:return re(n)}return n},h=(e,t,...n)=>y(f(e,o(t),...n)),g={[oe]:(e,t,n)=>h(oe,e,l(t),n.map(l)),[ae]:(e,t)=>h(ae,e,t.map(l)),[ie]:(e,t,n)=>{const{get:r,set:s,value:o}=n;return typeof r===I&&(n.get=l(r)),typeof s===I&&(n.set=l(s)),typeof o===I&&(n.value=l(o)),h(ie,e,l(t),n)},[le]:(e,t)=>h(le,e,l(t)),[fe]:e=>h(fe,e),[ce]:(e,t)=>t===s?e:h(ce,e,l(t)),[ue]:(e,t)=>{const n=h(ue,e,l(t));return n&&Z(n,y)},[pe]:(e,t)=>t===s||h(pe,e,l(t)),[de]:e=>h(de,e),[me]:e=>h(me,e).map(y),[ye]:e=>h(ye,e),[he]:(e,t,n)=>h(he,e,l(t),l(n)),[ge]:(e,t)=>h(ge,e,l(t))};t[u]=(e,t,s,o)=>{switch(e){case oe:return y(t).apply(y(s),o.map(y));case we:{const e=y(t);n.delete(r.get(e)),r.delete(e)}}};const w=new Proxy([W,null],g),_=w.Array[V];return J(Array,V,{value:e=>a(e)?_(e):i(e)}),{[e.toLowerCase()]:w,[`is${e}Proxy`]:a,proxy:t}}})("Window"),ve="function"==typeof Worker?Worker:class{};const Ee=new WeakMap,je=(e,...t)=>{const n=N(e,...t);if(!Ee.has(n)){const t=e instanceof ve?_e:be;Ee.set(n,t(n,h,g))}return Ee.get(n)};je.transfer=N.transfer;const ke=e=>e.arrayBuffer(),Se=e=>e.json(),Ae=e=>e.text();const Pe={object(...e){return this.string(function(e){for(var t=e[0],n=1,r=arguments.length;n<r;n++)t+=arguments[n]+e[n];return t}(...e))},string(e){for(const t of e.split(/[\r\n]+/))if(t.trim().length){/^(\s+)/.test(t)&&(e=e.replace(new RegExp("^"+RegExp.$1,"gm"),""));break}return e}},xe=(e,...t)=>Pe[typeof e](e,...t),{isArray:$e}=Array,{assign:Re,create:Te,defineProperties:Me,defineProperty:Oe,entries:Ne}=Object,{all:We,resolve:Ie}=new Proxy(Promise,{get:(e,t)=>e[t].bind(e)}),Ce=(e,t=location.href)=>new URL(e,t.replace(/^blob:/,"")).href;let Fe=0;const Le=(e,t)=>({id:e.id||(e.id=`${t}-w${Fe++}`),tag:e.tagName}),Be=(e,t,n=!1,r=CustomEvent)=>{e.dispatchEvent(new r(`${t}:ready`,{bubbles:!0,detail:{worker:n}}))},Je=new WeakMap,De=e=>{const t=e||console,n={stderr:(t.stderr||console.error).bind(t),stdout:(t.stdout||console.log).bind(t)};return{stderr:(...e)=>n.stderr(...e),stdout:(...e)=>n.stdout(...e),async get(e){const t=await e;return Je.set(t,n),t}}},He=({FS:e,PATH:t,PATH_FS:n},r,s)=>{const o=n.resolve(r);return e.mkdirTree(t.dirname(o)),e.writeFile(o,new Uint8Array(s),{canOwn:!0})},Ue=e=>{const t=e.split("/");return t.pop(),t.join("/")},qe=(e,t)=>{const n=[];for(const r of t.split("/"))"."!==r&&(n.push(r),r&&e.mkdir(n.join("/")))},ze=(e,t)=>{const n=[];for(const e of t.split("/"))switch(e){case"":case".":break;case"..":n.pop();break;default:n.push(e)}return[e.cwd()].concat(n).join("/").replace(/^\/+/,"/")},Ye=e=>{const t=e.map((e=>e.trim().replace(/(^[/]*|[/]*$)/g,""))).filter((e=>""!==e&&"."!==e)).join("/");return e[0].startsWith("/")?`/${t}`:t},Qe=new WeakMap,Xe=(e,t,n)=>We((e=>{for(const{files:t,to_file:n,from:r=""}of e){if(void 0!==t&&void 0!==n)throw new Error("Cannot use 'to_file' and 'files' parameters together!");if(void 0===t&&void 0===n&&r.endsWith("/"))throw new Error(`Couldn't determine the filename from the path ${r}, please supply 'to_file' parameter.`)}return e.flatMap((({from:e="",to_folder:t=".",to_file:n,files:r})=>{if($e(r))return r.map((n=>({url:Ye([e,n]),path:Ye([t,n])})));const s=n||e.slice(1+e.lastIndexOf("/"));return[{url:e,path:Ye([t,s])}]}))})(n).map((({url:r,path:s})=>((e,t)=>fetch(Ce(t,Qe.get(e))))(n,r).then(ke).then((n=>e.writeFile(t,s,n)))))),Ke=(e,t,n)=>{e.registerJsModule(t,n)},Ge=(e,t,...n)=>{try{return e.runPython(xe(t),...n)}catch(t){Je.get(e).stderr(t)}},Ve=async(e,t,...n)=>{try{return await e.runPythonAsync(xe(t),...n)}catch(t){Je.get(e).stderr(t)}},Ze=async(e,t,n)=>{const[r,...s]=t.split(".");let o,a=e.globals.get(r);for(const e of s)[o,a]=[a,a[e]];try{await a.call(o,n)}catch(t){Je.get(e).stderr(t)}};var et={type:"micropython",module:(e="1.20.0-297")=>`https://cdn.jsdelivr.net/npm/@micropython/micropython-webassembly-pyscript@${e}/micropython.mjs`,async engine({loadMicroPython:e},t,n){const{stderr:r,stdout:s,get:o}=De();n=n.replace(/\.m?js$/,".wasm");const a=await o(e({stderr:r,stdout:s,url:n}));return t.fetch&&await Xe(this,a,t.fetch),a},registerJSModule:Ke,run:Ge,runAsync:Ve,runEvent:Ze,transform:(e,t)=>t,writeFile:({FS:e,_module:{PATH:t,PATH_FS:n}},r,s)=>He({FS:e,PATH:t,PATH_FS:n},r,s)};const tt={dict_converter:Object.fromEntries};var nt={type:"pyodide",module:(e="0.23.4")=>`https://cdn.jsdelivr.net/pyodide/v${e}/full/pyodide.mjs`,async engine({loadPyodide:e},t,n){const{stderr:r,stdout:s,get:o}=De(),a=n.slice(0,n.lastIndexOf("/")),i=await o(e({stderr:r,stdout:s,indexURL:a}));if(t.fetch&&await Xe(this,i,t.fetch),t.packages){await i.loadPackage("micropip");const e=await i.pyimport("micropip");await e.install(t.packages),e.destroy()}return i},registerJSModule:Ke,run:Ge,runAsync:Ve,runEvent:Ze,transform:(e,t)=>t instanceof e.ffi.PyProxy?t.toJs(tt):t,writeFile:({FS:e,PATH:t,_module:{PATH_FS:n}},r,s)=>He({FS:e,PATH:t,PATH_FS:n},r,s)};const rt="ruby-wasm-wasi",st=rt.replace(/\W+/g,"_");var ot={type:rt,experimental:!0,module:(e="2.0.0")=>`https://cdn.jsdelivr.net/npm/ruby-3_2-wasm-wasi@${e}/dist/browser.esm.js`,async engine({DefaultRubyVM:e},t,n){const r=await fetch(`${n.slice(0,n.lastIndexOf("/"))}/ruby.wasm`),s=await WebAssembly.compile(await r.arrayBuffer()),{vm:o}=await e(s);return t.fetch&&await Xe(this,o,t.fetch),o},registerJSModule(e,t,n){const r=`__module_${st}_${t}`;globalThis[r]=n,this.run(e,`require "js";$${t}=JS.global[:${r}]`),delete globalThis[r]},run:(e,t,...n)=>e.eval(xe(t),...n),runAsync:(e,t,...n)=>e.evalAsync(xe(t),...n),async runEvent(e,t,n){if(/^xworker\.(on\w+)$/.test(t)){const{$1:t}=RegExp,r=`__module_${st}_event`;globalThis[r]=n,this.run(e,`require "js";$xworker.call("${t}",JS.global[:${r}])`),delete globalThis[r]}else{const r=this.run(e,`method(:${t})`);await r.call(t,e.wrap(n))}},transform:(e,t)=>t,writeFile:()=>{throw new Error(`writeFile is not supported in ${rt}`)}};var at={type:"wasmoon",module:(e="1.15.0")=>`https://cdn.jsdelivr.net/npm/wasmoon@${e}/+esm`,async engine({LuaFactory:e,LuaLibraries:t},n){const{stderr:r,stdout:s,get:o}=De(),a=await o((new e).createEngine());return a.global.getTable(t.Base,(e=>{a.global.setField(e,"print",s),a.global.setField(e,"printErr",r)})),n.fetch&&await Xe(this,a,n.fetch),a},registerJSModule:(e,t,n)=>{e.global.set(t,n)},run:(e,t,...n)=>{try{return e.doStringSync(xe(t),...n)}catch(t){Je.get(e).stderr(t)}},runAsync:async(e,t,...n)=>{try{return await e.doString(xe(t),...n)}catch(t){Je.get(e).stderr(t)}},runEvent:async(e,t,n)=>{const[r,...s]=t.split(".");let o,a=e.global.get(r);for(const e of s)[o,a]=[a,a[e]];try{await a.call(o,n)}catch(t){Je.get(e).stderr(t)}},transform:(e,t)=>t,writeFile:({cmodule:{module:{FS:e}}},t,n)=>((e,t,n)=>(qe(e,Ue(t)),t=ze(e,t),e.writeFile(t,new Uint8Array(n),{canOwn:!0})))(e,t,n)};const it=new Map,lt=new Map,ct=[],ut=[],ft=new Proxy(new Map,{get(e,t){if(!e.has(t)){const[n,...r]=t.split("@"),s=it.get(n),o=/^https?:\/\//i.test(r)?r.join("@"):s.module(...r);e.set(t,{url:o,module:import(o),engine:s.engine.bind(s)})}const{url:n,module:r,engine:s}=e.get(t);return(e,o)=>r.then((r=>{lt.set(t,e);const a=e?.fetch;return a&&Qe.set(a,o),s(r,e,n)}))}}),pt=e=>{for(const t of[].concat(e.type))it.set(t,e),ct.push(`script[type="${t}"]`),ut.push(`${t}-`)};for(const e of[et,nt,ot,at])pt(e);const dt=async e=>(await import("https://cdn.jsdelivr.net/npm/basic-toml@0.3.1/es.js")).parse(e),mt=e=>{let t=typeof e;return"string"===t&&/\.(json|toml|txt)$/.test(e)?t=RegExp.$1:e="./config.txt",[Ce(e),t]},yt=(e,t,n={})=>{if(t){const[e,r]=mt(t);if("json"===r)n=fetch(e).then(Se);else if("toml"===r)n=fetch(e).then(Ae).then(dt);else if("string"===r)try{n=JSON.parse(t)}catch(e){n=dt(t)}else"object"===r&&t&&(n=t);t=e}return Ie(n).then((n=>ft[e](n,t)))},ht=(e,t="")=>`${e}@${t}`.replace(/@$/,""),gt=[["beforeRun","codeBeforeRunWorker"],["beforeRunAsync","codeBeforeRunWorkerAsync"],["afterRun","codeAfterRunWorker"],["afterRunAsync","codeAfterRunWorkerAsync"]];class wt{constructor(e,t){this.interpreter=e,this.onWorkerReady=t.onWorkerReady;for(const[e,n]of gt)this[e]=t[n]?.()}get stringHooks(){const e={};for(const[t]of gt)this[t]&&(e[t]=xe(this[t]));return e}}var _t=(...e)=>function(t,n){const r=new Worker(URL.createObjectURL(new Blob(['const e="object"==typeof self?self:globalThis,t=t=>((t,r)=>{const n=(e,r)=>(t.set(r,e),e),s=o=>{if(t.has(o))return t.get(o);const[a,i]=r[o];switch(a){case 0:case-1:return n(i,o);case 1:{const e=n([],o);for(const t of i)e.push(s(t));return e}case 2:{const e=n({},o);for(const[t,r]of i)e[s(t)]=s(r);return e}case 3:return n(new Date(i),o);case 4:{const{source:e,flags:t}=i;return n(new RegExp(e,t),o)}case 5:{const e=n(new Map,o);for(const[t,r]of i)e.set(s(t),s(r));return e}case 6:{const e=n(new Set,o);for(const t of i)e.add(s(t));return e}case 7:{const{name:t,message:r}=i;return n(new e[t](r),o)}case 8:return n(BigInt(i),o);case"BigInt":return n(Object(BigInt(i)),o)}return n(new e[a](i),o)};return s})(new Map,t)(0),r="",{toString:n}={},{keys:s}=Object,o=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const s=n.call(e).slice(8,-1);switch(s){case"Array":return[1,r];case"Object":return[2,r];case"Date":return[3,r];case"RegExp":return[4,r];case"Map":return[5,r];case"Set":return[6,r]}return s.includes("Array")?[1,s]:s.includes("Error")?[7,s]:[2,s]},a=([e,t])=>0===e&&("function"===t||"symbol"===t),i=(e,{json:t,lossy:r}={})=>{const n=[];return((e,t,r,n)=>{const i=(e,t)=>{const s=n.push(e)-1;return r.set(t,s),s},c=n=>{if(r.has(n))return r.get(n);let[l,u]=o(n);switch(l){case 0:{let t=n;switch(u){case"bigint":l=8,t=n.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+u);t=null;break;case"undefined":return i([-1],n)}return i([l,t],n)}case 1:{if(u)return i([u,[...n]],n);const e=[],t=i([l,e],n);for(const t of n)e.push(c(t));return t}case 2:{if(u)switch(u){case"BigInt":return i([u,n.toString()],n);case"Boolean":case"Number":case"String":return i([u,n.valueOf()],n)}if(t&&"toJSON"in n)return c(n.toJSON());const r=[],f=i([l,r],n);for(const t of s(n))!e&&a(o(n[t]))||r.push([c(t),c(n[t])]);return f}case 3:return i([l,n.toISOString()],n);case 4:{const{source:e,flags:t}=n;return i([l,{source:e,flags:t}],n)}case 5:{const t=[],r=i([l,t],n);for(const[r,s]of n)(e||!a(o(r))&&!a(o(s)))&&t.push([c(r),c(s)]);return r}case 6:{const t=[],r=i([l,t],n);for(const r of n)!e&&a(o(r))||t.push(c(r));return r}}const{message:f}=n;return i([l,{name:u,message:f}],n)};return c})(!(t||r),!!t,new Map,n)(e),n},{parse:c,stringify:l}=JSON,u={json:!0,lossy:!0};var f=Object.freeze({__proto__:null,parse:e=>t(c(e)),stringify:e=>l(i(e,u))});const p="3099687a-04a9-4406-a08e-fd1602cb2a81",d="M"+p,g="T"+p;var y=e=>({value:new Promise((t=>{let r=new Worker("data:application/javascript,onmessage%3D(%7Bdata%3Ab%7D)%3D%3E(Atomics.wait(b%2C0)%2CpostMessage(0))");r.onmessage=t,r.postMessage(e)}))})\n/*! (c) Andrea Giammarchi - ISC */;const{Int32Array:w,Map:h,SharedArrayBuffer:m,Uint16Array:b}=globalThis,{BYTES_PER_ELEMENT:v}=w,{BYTES_PER_ELEMENT:S}=b,{isArray:E}=Array,{notify:P,wait:A,waitAsync:$}=Atomics,{fromCharCode:M}=String,j=(e,t)=>e?($||y)(t,0):(A(t,0),{value:{then:e=>e()}}),k=new WeakSet,x=new WeakMap;let T=0;const _=(e,{parse:t,stringify:r,transform:n}=JSON)=>{if(!x.has(e)){const s=(t,...r)=>e.postMessage({[p]:r},{transfer:t});let o=!1;x.set(e,new Proxy(new h,{has:(e,t)=>"string"==typeof t&&!t.startsWith("_"),get:(r,a)=>"then"===a?null:(...r)=>{const i=T++;let c=new w(new m(v)),l=[];k.has(r.at(-1)||l)&&k.delete(l=r.pop()),s(l,i,c,a,n?r.map(n):r);const u=e!==globalThis;let f=0;return o&&u&&(f=setTimeout(console.warn,1e3,`ðŸ’€ðŸ”’ - Possible deadlock if proxy.${a}(...args) is awaited`)),j(u,c).value.then((()=>{clearTimeout(f);const e=c[0];if(!e)return;const r=S*e;return c=new w(new m(r+r%v)),s([],i,c),j(u,c).value.then((()=>t(M(...new b(c.buffer).slice(0,e)))))}))},set(t,s,a){if(!t.size){const s=new h;e.addEventListener("message",(async e=>{const a=e.data?.[p];if(E(a)){e.stopImmediatePropagation();const[i,c,...l]=a;if(l.length){const[e,a]=l;if(!t.has(e))throw new Error(`Unsupported action: ${e}`);o=!0;try{const o=await t.get(e)(...a);if(void 0!==o){const e=r(n?n(o):o);s.set(i,e),c[0]=e.length}}finally{o=!1}}else{const e=s.get(i);s.delete(i);for(let t=new b(c.buffer),r=0;r<e.length;r++)t[r]=e.charCodeAt(r)}P(c,0)}}))}return!!t.set(s,a)}}))}return x.get(e)};_.transfer=(...e)=>(k.add(e),e);const O="object",F="function",R="number",W="string",B="undefined",J="symbol",{defineProperty:C,getOwnPropertyDescriptor:I,getPrototypeOf:L,isExtensible:H,ownKeys:D,preventExtensions:N,set:U,setPrototypeOf:z}=Reflect,{assign:q,create:K}=Object,Y=L(Int8Array),G="isArray",V=(e,t)=>{const{get:r,set:n,value:s}=e;return r&&(e.get=t(r)),n&&(e.set=t(n)),s&&(e.value=t(s)),e},Q=(e,t)=>[e,t],X=e=>t=>{const r=typeof t;switch(r){case O:if(null==t)return Q("null",t);if(t===globalThis)return Q(O,null);case F:return e(r,t);case"boolean":case R:case W:case B:case"bigint":return Q(r,t);case J:if(Z.has(t))return Q(r,Z.get(t))}throw new Error(`Unable to handle this ${r} type`)},Z=new Map(D(Symbol).filter((e=>typeof Symbol[e]===J)).map((e=>[Symbol[e],e]))),ee=e=>{for(const[t,r]of Z)if(r===e)return t};function te(){return this}const re="apply",ne="construct",se="defineProperty",oe="deleteProperty",ae="get",ie="getOwnPropertyDescriptor",ce="getPrototypeOf",le="has",ue="isExtensible",fe="ownKeys",pe="preventExtensions",de="set",ge="setPrototypeOf",ye="delete";var we=((e,t)=>{const r=t&&new WeakMap;if(t){const{addEventListener:e}=EventTarget.prototype;C(EventTarget.prototype,"addEventListener",{value(t,n,...s){return s.at(0)?.invoke&&(r.has(this)||r.set(this,new Map),r.get(this).set(t,[].concat(s[0].invoke)),delete s[0].invoke),e.call(this,t,n,...s)}})}const n=t&&(e=>{const{currentTarget:t,target:n,type:s}=e;for(const o of r.get(t||n)?.get(s)||[])e[o]()});return(r,s,o,...a)=>{let i=0;const c=new Map,l=new Map,{[o]:u}=r,f=a.length?q(K(globalThis),...a):globalThis,p=X(((e,t)=>{if(!c.has(t)){let e;for(;l.has(e=i++););c.set(t,e),l.set(e,t)}return Q(e,c.get(t))})),d=new FinalizationRegistry((e=>{u(ye,Q(W,e))})),g=([e,r])=>{switch(e){case O:if(null==r)return f;if(typeof r===R)return l.get(r);if(!(r instanceof Y))for(const e in r)r[e]=g(r[e]);return r;case F:if(typeof r===W){if(!l.has(r)){const e=function(...e){return t&&e.at(0)instanceof Event&&n(...e),u(re,Q(F,r),p(this),e.map(p))},s=new WeakRef(e);l.set(r,s),d.register(e,r,s)}return l.get(r).deref()}return l.get(r);case J:return ee(r)}return r},y={[re]:(e,t,r)=>p(e.apply(t,r)),[ne]:(e,t)=>p(new e(...t)),[se]:(e,t,r)=>p(C(e,t,r)),[oe]:(e,t)=>p(delete e[t]),[ce]:e=>p(L(e)),[ae]:(e,t)=>p(e[t]),[ie]:(e,t)=>{const r=I(e,t);return r?Q(O,V(r,p)):Q(B,r)},[le]:(e,t)=>p(t in e),[ue]:e=>p(H(e)),[fe]:e=>Q(O,D(e).map(p)),[pe]:e=>p(N(e)),[de]:(e,t,r)=>p(U(e,t,r)),[ge]:(e,t)=>p(z(e,t)),[ye](e){c.delete(l.get(e)),l.delete(e)}};return r[s]=(e,t,...r)=>{switch(e){case re:r[0]=g(r[0]),r[1]=r[1].map(g);break;case ne:r[0]=r[0].map(g);break;case se:{const[e,t]=r;r[0]=g(e);const{get:n,set:s,value:o}=t;n&&(t.get=g(n)),s&&(t.set=g(s)),o&&(t.value=g(o));break}default:r=r.map(g)}return y[e](g(t),...r)},{proxy:r,[e.toLowerCase()]:f,[`is${e}Proxy`]:()=>!1}}})("Window",!0),he=(e=>{let t=0;const r=new Map,n=new Map,s=Symbol(),o=e=>typeof e===F?e():e,a=e=>typeof e===O&&!!e&&s in e,i=Array[G],c=X(((e,a)=>{if(s in a)return o(a[s]);if(e===F){if(!n.has(a)){let e;for(;n.has(e=String(t++)););r.set(a,e),n.set(e,a)}return Q(e,r.get(a))}if(!(a instanceof Y))for(const e in a)a[e]=c(a[e]);return Q(e,a)}));return(t,l,u)=>{const{[l]:f}=t,p=new Map,d=new FinalizationRegistry((e=>{p.delete(e),f(ye,c(e))})),g=e=>{const[t,r]=e;if(!p.has(r)){const n=t===F?te.bind(e):e,s=new Proxy(n,h),o=new WeakRef(s);p.set(r,o),d.register(s,r,o)}return p.get(r).deref()},y=e=>{const[t,r]=e;switch(t){case O:return null===r?globalThis:typeof r===R?g(e):r;case F:return typeof r===W?n.get(r):g(e);case J:return ee(r)}return r},w=(e,t,...r)=>y(f(e,o(t),...r)),h={[re]:(e,t,r)=>w(re,e,c(t),r.map(c)),[ne]:(e,t)=>w(ne,e,t.map(c)),[se]:(e,t,r)=>{const{get:n,set:s,value:o}=r;return typeof n===F&&(r.get=c(n)),typeof s===F&&(r.set=c(s)),typeof o===F&&(r.value=c(o)),w(se,e,c(t),r)},[oe]:(e,t)=>w(oe,e,c(t)),[ce]:e=>w(ce,e),[ae]:(e,t)=>t===s?e:w(ae,e,c(t)),[ie]:(e,t)=>{const r=w(ie,e,c(t));return r&&V(r,y)},[le]:(e,t)=>t===s||w(le,e,c(t)),[ue]:e=>w(ue,e),[fe]:e=>w(fe,e).map(y),[pe]:e=>w(pe,e),[de]:(e,t,r)=>w(de,e,c(t),c(r)),[ge]:(e,t)=>w(ge,e,c(t))};t[u]=(e,t,s,o)=>{switch(e){case re:return y(t).apply(y(s),o.map(y));case ye:{const e=y(t);r.delete(n.get(e)),n.delete(e)}}};const m=new Proxy([O,null],h),b=m.Array[G];return C(Array,G,{value:e=>a(e)?b(e):i(e)}),{[e.toLowerCase()]:m,[`is${e}Proxy`]:a,proxy:t}}})("Window"),me="function"==typeof Worker?Worker:class{};const be=new WeakMap,ve=(e,...t)=>{const r=_(e,...t);if(!be.has(r)){const t=e instanceof me?we:he;be.set(r,t(r,d,g))}return be.get(r)};ve.transfer=_.transfer;const Se={object(...e){return this.string(function(e){for(var t=e[0],r=1,n=arguments.length;r<n;r++)t+=arguments[r]+e[r];return t}(...e))},string(e){for(const t of e.split(/[\\r\\n]+/))if(t.trim().length){/^(\\s+)/.test(t)&&(e=e.replace(new RegExp("^"+RegExp.$1,"gm"),""));break}return e}},Ee=(e,...t)=>Se[typeof e](e,...t),{isArray:Pe}=Array,{assign:Ae,create:$e,defineProperties:Me,defineProperty:je,entries:ke}=Object,{all:xe,resolve:Te}=new Proxy(Promise,{get:(e,t)=>e[t].bind(e)}),_e=(e,t=location.href)=>new URL(e,t.replace(/^blob:/,"")).href,Oe=(e,t,r=!1,n=CustomEvent)=>{e.dispatchEvent(new n(`${t}:ready`,{bubbles:!0,detail:{worker:r}}))};Promise.withResolvers||(Promise.withResolvers=function(){var e,t,r=new this((function(r,n){e=r,t=n}));return{resolve:e,reject:t,promise:r}});const Fe=e=>e.arrayBuffer(),Re=e=>e.json(),We=e=>e.text(),Be=new WeakMap,Je=e=>{const t=e||console,r={stderr:(t.stderr||console.error).bind(t),stdout:(t.stdout||console.log).bind(t)};return{stderr:(...e)=>r.stderr(...e),stdout:(...e)=>r.stdout(...e),async get(e){const t=await e;return Be.set(t,r),t}}},Ce=({FS:e,PATH:t,PATH_FS:r},n,s)=>{const o=r.resolve(n);return e.mkdirTree(t.dirname(o)),e.writeFile(o,new Uint8Array(s),{canOwn:!0})},Ie=e=>{const t=e.split("/");return t.pop(),t.join("/")},Le=(e,t)=>{const r=[];for(const n of t.split("/"))"."!==n&&(r.push(n),n&&e.mkdir(r.join("/")))},He=(e,t)=>{const r=[];for(const e of t.split("/"))switch(e){case"":case".":break;case"..":r.pop();break;default:r.push(e)}return[e.cwd()].concat(r).join("/").replace(/^\\/+/,"/")},De=e=>{const t=e.map((e=>e.trim().replace(/(^[/]*|[/]*$)/g,""))).filter((e=>""!==e&&"."!==e)).join("/");return e[0].startsWith("/")?`/${t}`:t},Ne=new WeakMap,Ue=(e,t,r)=>xe((e=>{for(const{files:t,to_file:r,from:n=""}of e){if(void 0!==t&&void 0!==r)throw new Error("Cannot use \'to_file\' and \'files\' parameters together!");if(void 0===t&&void 0===r&&n.endsWith("/"))throw new Error(`Couldn\'t determine the filename from the path ${n}, please supply \'to_file\' parameter.`)}return e.flatMap((({from:e="",to_folder:t=".",to_file:r,files:n})=>{if(Pe(n))return n.map((r=>({url:De([e,r]),path:De([t,r])})));const s=r||e.slice(1+e.lastIndexOf("/"));return[{url:e,path:De([t,s])}]}))})(r).map((({url:n,path:s})=>((e,t)=>fetch(_e(t,Ne.get(e))))(r,n).then(Fe).then((r=>e.writeFile(t,s,r)))))),ze=(e,t,r)=>{e.registerJsModule(t,r)},qe=(e,t,...r)=>{try{return e.runPython(Ee(t),...r)}catch(t){Be.get(e).stderr(t)}},Ke=async(e,t,...r)=>{try{return await e.runPythonAsync(Ee(t),...r)}catch(t){Be.get(e).stderr(t)}},Ye=async(e,t,r)=>{const[n,...s]=t.split(".");let o,a=e.globals.get(n);for(const e of s)[o,a]=[a,a[e]];try{await a.call(o,r)}catch(t){Be.get(e).stderr(t)}};var Ge={type:"micropython",module:(e="1.20.0-297")=>`https://cdn.jsdelivr.net/npm/@micropython/micropython-webassembly-pyscript@${e}/micropython.mjs`,async engine({loadMicroPython:e},t,r){const{stderr:n,stdout:s,get:o}=Je();r=r.replace(/\\.m?js$/,".wasm");const a=await o(e({stderr:n,stdout:s,url:r}));return t.fetch&&await Ue(this,a,t.fetch),a},registerJSModule:ze,run:qe,runAsync:Ke,runEvent:Ye,transform:(e,t)=>t,writeFile:({FS:e,_module:{PATH:t,PATH_FS:r}},n,s)=>Ce({FS:e,PATH:t,PATH_FS:r},n,s)};const Ve={dict_converter:Object.fromEntries};var Qe={type:"pyodide",module:(e="0.23.4")=>`https://cdn.jsdelivr.net/pyodide/v${e}/full/pyodide.mjs`,async engine({loadPyodide:e},t,r){const{stderr:n,stdout:s,get:o}=Je(),a=r.slice(0,r.lastIndexOf("/")),i=await o(e({stderr:n,stdout:s,indexURL:a}));if(t.fetch&&await Ue(this,i,t.fetch),t.packages){await i.loadPackage("micropip");const e=await i.pyimport("micropip");await e.install(t.packages),e.destroy()}return i},registerJSModule:ze,run:qe,runAsync:Ke,runEvent:Ye,transform:(e,t)=>t instanceof e.ffi.PyProxy?t.toJs(Ve):t,writeFile:({FS:e,PATH:t,_module:{PATH_FS:r}},n,s)=>Ce({FS:e,PATH:t,PATH_FS:r},n,s)};const Xe="ruby-wasm-wasi",Ze=Xe.replace(/\\W+/g,"_");var et={type:Xe,experimental:!0,module:(e="2.0.0")=>`https://cdn.jsdelivr.net/npm/ruby-3_2-wasm-wasi@${e}/dist/browser.esm.js`,async engine({DefaultRubyVM:e},t,r){const n=await fetch(`${r.slice(0,r.lastIndexOf("/"))}/ruby.wasm`),s=await WebAssembly.compile(await n.arrayBuffer()),{vm:o}=await e(s);return t.fetch&&await Ue(this,o,t.fetch),o},registerJSModule(e,t,r){const n=`__module_${Ze}_${t}`;globalThis[n]=r,this.run(e,`require "js";$${t}=JS.global[:${n}]`),delete globalThis[n]},run:(e,t,...r)=>e.eval(Ee(t),...r),runAsync:(e,t,...r)=>e.evalAsync(Ee(t),...r),async runEvent(e,t,r){if(/^xworker\\.(on\\w+)$/.test(t)){const{$1:t}=RegExp,n=`__module_${Ze}_event`;globalThis[n]=r,this.run(e,`require "js";$xworker.call("${t}",JS.global[:${n}])`),delete globalThis[n]}else{const n=this.run(e,`method(:${t})`);await n.call(t,e.wrap(r))}},transform:(e,t)=>t,writeFile:()=>{throw new Error(`writeFile is not supported in ${Xe}`)}};var tt={type:"wasmoon",module:(e="1.15.0")=>`https://cdn.jsdelivr.net/npm/wasmoon@${e}/+esm`,async engine({LuaFactory:e,LuaLibraries:t},r){const{stderr:n,stdout:s,get:o}=Je(),a=await o((new e).createEngine());return a.global.getTable(t.Base,(e=>{a.global.setField(e,"print",s),a.global.setField(e,"printErr",n)})),r.fetch&&await Ue(this,a,r.fetch),a},registerJSModule:(e,t,r)=>{e.global.set(t,r)},run:(e,t,...r)=>{try{return e.doStringSync(Ee(t),...r)}catch(t){Be.get(e).stderr(t)}},runAsync:async(e,t,...r)=>{try{return await e.doString(Ee(t),...r)}catch(t){Be.get(e).stderr(t)}},runEvent:async(e,t,r)=>{const[n,...s]=t.split(".");let o,a=e.global.get(n);for(const e of s)[o,a]=[a,a[e]];try{await a.call(o,r)}catch(t){Be.get(e).stderr(t)}},transform:(e,t)=>t,writeFile:({cmodule:{module:{FS:e}}},t,r)=>((e,t,r)=>(Le(e,Ie(t)),t=He(e,t),e.writeFile(t,new Uint8Array(r),{canOwn:!0})))(e,t,r)};const rt=new Map,nt=new Map,st=new Proxy(new Map,{get(e,t){if(!e.has(t)){const[r,...n]=t.split("@"),s=rt.get(r),o=/^https?:\\/\\//i.test(n)?n.join("@"):s.module(...n);e.set(t,{url:o,module:import(o),engine:s.engine.bind(s)})}const{url:r,module:n,engine:s}=e.get(t);return(e,o)=>n.then((n=>{nt.set(t,e);const a=e?.fetch;return a&&Ne.set(a,o),s(n,e,r)}))}}),ot=e=>{for(const t of[].concat(e.type))rt.set(t,e)};for(const e of[Ge,Qe,et,tt])ot(e);const at=async e=>(await import("https://cdn.jsdelivr.net/npm/basic-toml@0.3.1/es.js")).parse(e),it=(e,t,r={})=>{if(t){const[e,n]=(e=>{let t=typeof e;return"string"===t&&/\\.(json|toml|txt)$/.test(e)?t=RegExp.$1:e="./config.txt",[_e(e),t]})(t);if("json"===n)r=fetch(e).then(Re);else if("toml"===n)r=fetch(e).then(We).then(at);else if("string"===n)try{r=JSON.parse(t)}catch(e){r=at(t)}else"object"===n&&t&&(r=t);t=e}return Te(r).then((r=>st[e](r,t)))};try{new SharedArrayBuffer(4)}catch(e){throw new Error(["Unable to use SharedArrayBuffer due insecure environment.","Please read requirements in MDN: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer#security_requirements"].join("\\n"))}let ct,lt,ut;const ft=(e,t)=>{addEventListener(e,t||(async t=>{try{await ct,lt(`xworker.on${e}`,t)}catch(e){postMessage(e)}}),!!t&&{once:!0})},{parse:pt,stringify:dt}=f,{proxy:gt,window:yt,isWindowProxy:wt}=ve(self,{parse:pt,stringify:dt,transform:e=>ut?ut(e):e}),ht={sync:gt,window:yt,isWindowProxy:wt,onmessage:console.info,onerror:console.error,onmessageerror:console.warn,postMessage:postMessage.bind(self)};ft("message",(({data:{options:e,config:t,code:r,hooks:n}})=>{ct=(async()=>{try{const{id:s,tag:o,type:a,custom:i,version:c,config:l,async:u}=e,f=await it(((e,t="")=>`${e}@${t}`.replace(/@$/,""))(a,c),t,l),p=$e(rt.get(a)),d="run"+(u?"Async":"");if(n){const{beforeRun:e,beforeRunAsync:t,afterRun:r,afterRunAsync:s}=n,o=r||s,a=e||t;if(o){const e=p[d].bind(p);p[d]=(t,r,...n)=>e(t,`${r}\\n${o}`,...n)}if(a){const e=p[d].bind(p);p[d]=(t,r,...n)=>e(t,`${a}\\n${r}`,...n)}}const{CustomEvent:g,document:y}=yt,w=s&&y.getElementById(s)||null;let h="";return p.registerJSModule(f,"polyscript",{xworker:ht,get target(){return!h&&w&&("SCRIPT"===o?w.after(Ae(y.createElement(`script-${i||a}`),{id:h=`${s}-target`})):(h=s,w.replaceChildren(),w.style.display="block")),h}}),lt=p.runEvent.bind(p,f),ut=p.transform.bind(p,f),w&&Oe(w,i||a,!0,g),await p[d](f,r),f}catch(e){postMessage(e)}})(),ft("error"),ft("message"),ft("messageerror")}));\n'],{type:"application/javascript"})),{type:"module"}),{postMessage:s}=r,o=this instanceof wt;if(e.length){const[t,r]=e;(n=Re({},n||{type:t,version:r})).type||(n.type=t)}const[a]=mt(n.config),i=fetch(t).then(Ae).then((e=>{const t=o?this.stringHooks:void 0;s.call(r,{options:n,config:a,code:e,hooks:t})}));return Me(r,{postMessage:{value:(e,...t)=>i.then((()=>s.call(r,e,...t)))},sync:{value:je(r,m).proxy},onerror:{writable:!0,configurable:!0,value:console.error}}),o&&this.onWorkerReady?.(this.interpreter,r),r.addEventListener("message",(e=>{const{data:t}=e;t instanceof Error&&(e.stopImmediatePropagation(),r.onerror(Object.create(e,{type:{value:"error"},error:{value:t}})))})),r};const bt="Invalid content";var vt=e=>{const{src:t,worker:n}=e.attributes;if(n){let{value:r}=n;if(r)throw new SyntaxError("Invalid worker attribute");if(r=t?.value,!r){if(t)throw new SyntaxError("Invalid worker attribute");if(e.childElementCount){const{innerHTML:t,localName:n,type:s}=e,o=s||n.replace(/-script$/,"");console.warn(`Deprecated: use <script type="${o}"> for an always safe content parsing:\n`,t),r=t}else r=e.textContent;return URL.createObjectURL(new Blob([xe(r)],{type:"text/plain"}))}return r}if(t&&e.textContent.replace(/\/\*[\s\S]*?\*\//g,"").replace(/^\s*(?:\/\/|#).*/gm,"").trim())throw new SyntaxError(bt)};const Et=(t,n)=>{const r=(e=>{let t=e;for(;t.parentNode;)t=t.parentNode;return t})(t);return r.getElementById(n)||e(n,r)},jt=new WeakMap,kt={get(){let e=jt.get(this);return e||(e=document.createElement(`${this.type}-script`),jt.set(this,e),$t(this)),e},set(e){"string"==typeof e?jt.set(this,Et(this,e)):(jt.set(this,e),$t(this))}},St=new WeakMap,At=new Map,Pt=(e,t)=>{const n=e?.value;return n?t+n:""},xt=(e,t,n,r,s,o=e)=>{if(!At.has(t)){const a={interpreter:yt(n,s),queue:Ie(),XWorker:_t(e,r)};At.set(t,a),At.has(e)||At.set(e,a),At.has(o)||At.set(o,a)}return At.get(t)},$t=async e=>{if(St.has(e)){const{target:t}=e;t&&(e.closest("head")?document.body.append(t):e.after(t))}else{const{attributes:{async:t,config:n,env:r,target:s,version:o},src:a,type:i}=e,l=o?.value,c=ht(i,l);let u=Pt(n,"|");const f=Pt(r,"")||`${c}${u}`;u=u.slice(1);const p=vt(e);if(p){const n=new(_t(i,l))(p,{...Le(e,i),async:!!t,config:u});return void St.set(Oe(e,"xworker",{value:n}),{xworker:n})}const d=Pt(s,""),m=xt(i,f,c,l,u);St.set(Oe(e,"target",kt),m),d&&jt.set(e,Et(e,d));const y=a?fetch(a).then(Ae):e.textContent;m.queue=m.queue.then((()=>(async(e,t,n,r)=>{const{type:s}=e,o=it.get(s);o.experimental&&console.warn(`The ${s} interpreter is experimental`);const[a,i]=await We([St.get(e).interpreter,t]);try{return Oe(document,"currentScript",{configurable:!0,get:()=>e}),o.registerJSModule(a,"polyscript",{XWorker:n}),Be(e,s),o[r?"runAsync":"run"](a,i)}finally{delete document.currentScript}})(e,y,m.XWorker,!!t)))}};new Proxy(Te(null),{get:(e,t)=>Rt(t)});const Rt=async e=>{if(At.has(e)){const{interpreter:t,queue:n}=At.get(e);return(await We([t,n]))[0]}const t=At.size?`Available interpreters are: ${[...At.keys()].map((e=>`"${e}"`)).join(", ")}.`:"There are no interpreters in this page.";throw new Error(`The interpreter "${e}" was not found. ${t}`)},Tt=async e=>{const{type:t,currentTarget:r}=e;for(let{name:s,value:o,ownerElement:a}of n(`./@*[${ut.map((e=>`name()="${e}${t}"`)).join(" or ")}]`,r)){s=s.slice(0,-(t.length+1));const n=await Rt(a.getAttribute(`${s}-env`)||s);it.get(s).runEvent(n,o,e)}},Mt=e=>{for(let{name:t,ownerElement:r}of n(`.//@*[${ut.map((e=>`starts-with(name(),"${e}")`)).join(" or ")}]`,e))t=t.slice(t.lastIndexOf("-")+1),"env"!==t&&r.addEventListener(t,Tt)},Ot=[],Nt=new Map,Wt=new Map,It=e=>{for(const t of Ot)if(e.matches(t)){const n=Nt.get(t),{resolve:r}=Wt.get(n),{options:s,known:o}=Ct.get(n);if(!o.has(e)){o.add(e);const{interpreter:t,config:a,version:i,env:l,onInterpreterReady:c,onerror:u}=s;let f;try{const o=vt(e);if(o){const l=Jt.call(new wt(null,s),o,{...Le(e,n),version:i,type:t,custom:n,config:e.getAttribute("config")||a||{},async:e.hasAttribute("async")});return Oe(e,"xworker",{value:l}),void r({type:n,xworker:l})}}catch(e){f=e}const p=ht(t,i),d=l||`${p}${a?`|${a}`:""}`,{interpreter:m,XWorker:y}=xt(n,d,p,i,a,t);m.then((o=>{const a=Te(it.get(t)),{onBeforeRun:i,onBeforeRunAsync:l,onAfterRun:d,onAfterRunAsync:m}=s,h=new wt(o,s),g=function(...e){return y.apply(h,e)};for(const[t,[n,r]]of[["run",[i,d]]]){const s=a[t];a[t]=function(t,o,...a){n&&n.call(this,w,e);const i=s.call(this,t,o,...a);return r&&r.call(this,w,e),i}}for(const[t,[n,r]]of[["runAsync",[l,m]]]){const s=a[t];a[t]=async function(t,o,...a){n&&await n.call(this,w,e);const i=await s.call(this,t,o,...a);return r&&await r.call(this,w,e),i}}a.registerJSModule(o,"polyscript",{XWorker:g});const w={type:n,interpreter:o,XWorker:g,io:Je.get(o),config:structuredClone(lt.get(p)),run:a.run.bind(a,o),runAsync:a.runAsync.bind(a,o),runEvent:a.runEvent.bind(a,o)};r(w),f&&u?.(f,e),c?.(w,e)}))}}},Ct=new Map;let Ft=0;const Lt=(e,n)=>{let r=null==e;if(r)e="_ps"+Ft++;else if(it.has(e)||Ct.has(e))throw new Error(`<script type="${e}"> already registered`);if(!it.has(n?.interpreter))throw new Error("Unspecified interpreter");it.set(e,it.get(n.interpreter));const s=[`script[type="${e}"]`];if(Bt(e),r){const{onInterpreterReady:t}=n;n={...n,onInterpreterReady(n,r){Ot.splice(Ot.indexOf(e),1),it.delete(e),Ct.delete(e),Wt.delete(e),r.remove(),t?.(n)}},document.head.append(Re(document.createElement("script"),{type:e}))}else s.push(`${e}-script`),ut.push(`${e}-`);for(const t of s)Nt.set(t,e);Ot.push(...s),Ct.set(e,{options:Re({env:e},n),known:new WeakSet}),r||Mt(document),t(s.join(",")).forEach(It)},Bt=e=>(Wt.has(e)||Wt.set(e,Promise.withResolvers()),Wt.get(e).promise),Jt=_t(),Dt=ct.join(","),Ht=new MutationObserver((e=>{for(const{type:n,target:r,attributeName:s,addedNodes:o}of e)if("attributes"!==n){for(const e of o)if(1===e.nodeType)if(Mt(e),e.matches(Dt))$t(e);else{if(t(Dt,e).forEach($t),!Ot.length)continue;It(e),t(Ot.join(","),e).forEach(It)}}else{const e=s.lastIndexOf("-")+1;if(e){const t=s.slice(0,e);for(const n of ut)if(t===n){const t=s.slice(e);if("env"!==t){const e=r.hasAttribute(s)?"add":"remove";r[`${e}EventListener`](t,Tt)}break}}}})),Ut=e=>(Ht.observe(e,{childList:!0,subtree:!0,attributes:!0}),e),{attachShadow:qt}=Element.prototype;Re(Element.prototype,{attachShadow(e){return Ut(qt.call(this,e))}}),Mt(Ut(document)),t(Dt,document).forEach($t);const zt="PY0409",Yt="PY1000",Qt="PY0001",Xt="PY0401",Kt="PY0403",Gt="PY0404",Vt="PY0500",Zt="PY0503";class en extends Error{constructor(e,t="",n="text"){super(`(${e}): ${t}`),this.errorCode=e,this.messageType=n,this.name="UserError"}}class tn extends en{constructor(e,t){super(e,t),this.name="FetchError"}}var nn={sleep:e=>new Promise((t=>setTimeout(t,1e3*e)))};const{entries:rn}=Object,sn=["from pathlib import Path as _Path"],on=(e,t)=>{for(const[n,r]of rn(t)){const t=`_Path("${e}/${n}")`;if("string"==typeof r){const e=JSON.stringify(r);sn.push(`${t}.write_text(${e})`)}else sn.push(`${t}.mkdir(parents=True, exist_ok=True)`),on(`${e}/${n}`,r)}};on(".",{pyscript:{"__init__.py":'# Some notes about the naming conventions and the relationship between various\n# similar-but-different names.\n#\n# import pyscript\n#     this package contains the main user-facing API offered by pyscript. All\n#     the names which are supposed be used by end users should be made\n#     available in pyscript/__init__.py (i.e., this file)\n#\n# import _pyscript\n#     this is an internal module implemented in JS. It is used internally by\n#     the pyscript package, end users should not use it directly. For its\n#     implementation, grep for `interpreter.registerJsModule("_pyscript",\n#     ...)` in core.js\n#\n# import js\n#     this is the JS globalThis, as exported by pyodide and/or micropython\'s\n#     FFIs. As such, it contains different things in the main thread or in a\n#     worker.\n#\n# import pyscript.magic_js\n#     this submodule abstracts away some of the differences between the main\n#     thread and the worker. In particular, it defines `window` and `document`\n#     in such a way that these names work in both cases: in the main thread,\n#     they are the "real" objects, in the worker they are proxies which work\n#     thanks to coincident.\n#\n# from pyscript import window, document\n#     these are just the window and document objects as defined by\n#     pyscript.magic_js. This is the blessed way to access them from pyscript,\n#     as it works transparently in both the main thread and worker cases.\n\nfrom pyscript.magic_js import RUNNING_IN_WORKER, window, document, sync\nfrom pyscript.display import HTML, display\n\ntry:\n    from pyscript.event_handling import when\nexcept:\n    from pyscript.util import NotSupported\n\n    when = NotSupported(\n        "pyscript.when",\n        "pyscript.when currently not available with this interpreter"\n    )\n',"display.py":'import base64\nimport html\nimport io\nimport re\n\nfrom pyscript.magic_js import document, window, current_target\n\n_MIME_METHODS = {\n    "__repr__": "text/plain",\n    "_repr_html_": "text/html",\n    "_repr_markdown_": "text/markdown",\n    "_repr_svg_": "image/svg+xml",\n    "_repr_png_": "image/png",\n    "_repr_pdf_": "application/pdf",\n    "_repr_jpeg_": "image/jpeg",\n    "_repr_latex": "text/latex",\n    "_repr_json_": "application/json",\n    "_repr_javascript_": "application/javascript",\n    "savefig": "image/png",\n}\n\n\ndef _render_image(mime, value, meta):\n    # If the image value is using bytes we should convert it to base64\n    # otherwise it will return raw bytes and the browser will not be able to\n    # render it.\n    if isinstance(value, bytes):\n        value = base64.b64encode(value).decode("utf-8")\n\n    # This is the pattern of base64 strings\n    base64_pattern = re.compile(\n        r"^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$"\n    )\n    # If value doesn\'t match the base64 pattern we should encode it to base64\n    if len(value) > 0 and not base64_pattern.match(value):\n        value = base64.b64encode(value.encode("utf-8")).decode("utf-8")\n\n    data = f"data:{mime};charset=utf-8;base64,{value}"\n    attrs = " ".join([\'{k}="{v}"\' for k, v in meta.items()])\n    return f\'<img src="{data}" {attrs}></img>\'\n\n\ndef _identity(value, meta):\n    return value\n\n\n_MIME_RENDERERS = {\n    "text/plain": html.escape,\n    "text/html": _identity,\n    "image/png": lambda value, meta: _render_image("image/png", value, meta),\n    "image/jpeg": lambda value, meta: _render_image("image/jpeg", value, meta),\n    "image/svg+xml": _identity,\n    "application/json": _identity,\n    "application/javascript": lambda value, meta: f"<script>{value}<\\\\/script>",\n}\n\n\nclass HTML:\n    """\n    Wrap a string so that display() can render it as plain HTML\n    """\n\n    def __init__(self, html):\n        self._html = html\n\n    def _repr_html_(self):\n        return self._html\n\n\ndef _eval_formatter(obj, print_method):\n    """\n    Evaluates a formatter method.\n    """\n    if print_method == "__repr__":\n        return repr(obj)\n    elif hasattr(obj, print_method):\n        if print_method == "savefig":\n            buf = io.BytesIO()\n            obj.savefig(buf, format="png")\n            buf.seek(0)\n            return base64.b64encode(buf.read()).decode("utf-8")\n        return getattr(obj, print_method)()\n    elif print_method == "_repr_mimebundle_":\n        return {}, {}\n    return None\n\n\ndef _format_mime(obj):\n    """\n    Formats object using _repr_x_ methods.\n    """\n    if isinstance(obj, str):\n        return html.escape(obj), "text/plain"\n\n    mimebundle = _eval_formatter(obj, "_repr_mimebundle_")\n    if isinstance(mimebundle, tuple):\n        format_dict, _ = mimebundle\n    else:\n        format_dict = mimebundle\n\n    output, not_available = None, []\n    for method, mime_type in reversed(_MIME_METHODS.items()):\n        if mime_type in format_dict:\n            output = format_dict[mime_type]\n        else:\n            output = _eval_formatter(obj, method)\n\n        if output is None:\n            continue\n        elif mime_type not in _MIME_RENDERERS:\n            not_available.append(mime_type)\n            continue\n        break\n    if output is None:\n        if not_available:\n            window.console.warn(\n                f"Rendered object requested unavailable MIME renderers: {not_available}"\n            )\n        output = repr(output)\n        mime_type = "text/plain"\n    elif isinstance(output, tuple):\n        output, meta = output\n    else:\n        meta = {}\n    return _MIME_RENDERERS[mime_type](output, meta), mime_type\n\n\ndef _write(element, value, append=False):\n    html, mime_type = _format_mime(value)\n    if html == "\\\\n":\n        return\n\n    if append:\n        out_element = document.createElement("div")\n        element.append(out_element)\n    else:\n        out_element = element.lastElementChild\n        if out_element is None:\n            out_element = element\n\n    if mime_type in ("application/javascript", "text/html"):\n        script_element = document.createRange().createContextualFragment(html)\n        out_element.append(script_element)\n    else:\n        out_element.innerHTML = html\n\n\ndef display(*values, target=None, append=True):\n    if target is None:\n        target = current_target()\n\n    element = document.getElementById(target)\n\n    # if element is a <script type="py">, it has a \'target\' attribute which\n    # points to the visual element holding the displayed values. In that case,\n    # use that.\n    if element.tagName == \'SCRIPT\' and hasattr(element, \'target\'):\n        element = element.target\n\n    for v in values:\n        _write(element, v, append=append)\n',"event_handling.py":'import inspect\n\nfrom pyodide.ffi.wrappers import add_event_listener\nfrom pyscript.magic_js import document\n\n\ndef when(event_type=None, selector=None):\n    """\n    Decorates a function and passes py-* events to the decorated function\n    The events might or not be an argument of the decorated function\n    """\n\n    def decorator(func):\n        if isinstance(selector, str):\n            elements = document.querySelectorAll(selector)\n        else:\n            # TODO: This is a hack that will be removed when pyscript becomes a package\n            #       and we can better manage the imports without circular dependencies\n            from pyweb import pydom\n\n            if isinstance(selector, pydom.Element):\n                elements = [selector._js]\n            elif isinstance(selector, pydom.ElementCollection):\n                elements = [el._js for el in selector]\n            else:\n                raise ValueError(\n                    f"Invalid selector: {selector}. Selector must"\n                    " be a string, a pydom.Element or a pydom.ElementCollection."\n                )\n\n        sig = inspect.signature(func)\n        # Function doesn\'t receive events\n        if not sig.parameters:\n\n            def wrapper(*args, **kwargs):\n                func()\n\n            for el in elements:\n                add_event_listener(el, event_type, wrapper)\n        else:\n            for el in elements:\n                add_event_listener(el, event_type, func)\n        return func\n\n    return decorator\n',"magic_js.py":"from pyscript.util import NotSupported\nimport js as globalThis\n\nRUNNING_IN_WORKER = not hasattr(globalThis, \"document\")\n\nif RUNNING_IN_WORKER:\n    import polyscript\n\n    PyWorker = NotSupported(\n        'pyscript.PyWorker',\n        'pyscript.PyWorker works only when running in the main thread')\n    window = polyscript.xworker.window\n    document = window.document\n    sync = polyscript.xworker.sync\n\n    # in workers the display does not have a default ID\n    # but there is a sync utility from xworker\n    def current_target():\n        return polyscript.target\n\nelse:\n    import _pyscript\n    from _pyscript import PyWorker\n    window = globalThis\n    document = globalThis.document\n    sync = NotSupported(\n        'pyscript.sync',\n        'pyscript.sync works only when running in a worker')\n\n    # in MAIN the current element target exist, just use it\n    def current_target():\n        return _pyscript.target\n","util.py":'class NotSupported:\n    """\n    Small helper that raises exceptions if you try to get/set any attribute on\n    it.\n    """\n\n    def __init__(self, name, error):\n        object.__setattr__(self, "name", name)\n        object.__setattr__(self, "error", error)\n\n    def __repr__(self):\n        return f"<NotSupported {self.name} [{self.error}]>"\n\n    def __getattr__(self, attr):\n        raise AttributeError(self.error)\n\n    def __setattr__(self, attr, value):\n        raise AttributeError(self.error)\n\n    def __call__(self, *args):\n        raise TypeError(self.error)\n'},pyweb:{"pydom.py":'import sys\nimport warnings\nfrom functools import cached_property\nfrom typing import Any\n\nfrom pyodide.ffi import JsProxy\nfrom pyscript import display, document, window\n\n# from pyscript import when as _when\n\nalert = window.alert\n\n\nclass BaseElement:\n    def __init__(self, js_element):\n        self._js = js_element\n        self._parent = None\n        self.style = StyleProxy(self)\n\n    def __eq__(self, obj):\n        """Check if the element is the same as the other element by comparing\n        the underlying JS element"""\n        return isinstance(obj, BaseElement) and obj._js == self._js\n\n    @property\n    def parent(self):\n        if self._parent:\n            return self._parent\n\n        if self._js.parentElement:\n            self._parent = self.__class__(self._js.parentElement)\n\n        return self._parent\n\n    @property\n    def __class(self):\n        return self.__class__ if self.__class__ != PyDom else Element\n\n    def create(self, type_, is_child=True, classes=None, html=None, label=None):\n        js_el = document.createElement(type_)\n        element = self.__class(js_el)\n\n        if classes:\n            for class_ in classes:\n                element.add_class(class_)\n\n        if html is not None:\n            element.html = html\n\n        if label is not None:\n            element.label = label\n\n        if is_child:\n            self.append(element)\n\n        return element\n\n    def find(self, selector):\n        """Return an ElementCollection representing all the child elements that\n        match the specified selector.\n\n        Args:\n            selector (str): A string containing a selector expression\n\n        Returns:\n            ElementCollection: A collection of elements matching the selector\n        """\n        elements = self._js.querySelectorAll(selector)\n        if not elements:\n            return None\n        return ElementCollection([Element(el) for el in elements])\n\n\nclass Element(BaseElement):\n    @property\n    def children(self):\n        return [self.__class__(el) for el in self._js.children]\n\n    def append(self, child):\n        # TODO: this is Pyodide specific for now!!!!!!\n        # if we get passed a JSProxy Element directly we just map it to the\n        # higher level Python element\n        if isinstance(child, JsProxy):\n            return self.append(Element(child))\n\n        elif isinstance(child, Element):\n            self._js.appendChild(child._js)\n\n            return child\n\n        elif isinstance(child, ElementCollection):\n            for el in child:\n                self.append(el)\n\n    # -------- Pythonic Interface to Element -------- #\n    @property\n    def html(self):\n        return self._js.innerHTML\n\n    @html.setter\n    def html(self, value):\n        self._js.innerHTML = value\n\n    @property\n    def content(self):\n        # TODO: This breaks with with standard template elements. Define how to best\n        #       handle this specifica use case. Just not support for now?\n        if self._js.tagName == "TEMPLATE":\n            warnings.warn(\n                "Content attribute not supported for template elements.", stacklevel=2\n            )\n            return None\n        return self._js.innerHTML\n\n    @content.setter\n    def content(self, value):\n        # TODO: (same comment as above)\n        if self._js.tagName == "TEMPLATE":\n            warnings.warn(\n                "Content attribute not supported for template elements.", stacklevel=2\n            )\n            return\n\n        display(value, target=self.id)\n\n    @property\n    def id(self):\n        return self._js.id\n\n    @id.setter\n    def id(self, value):\n        self._js.id = value\n\n    def clone(self, new_id=None):\n        clone = Element(self._js.cloneNode(True))\n        clone.id = new_id\n\n        return clone\n\n    def remove_class(self, classname):\n        classList = self._js.classList\n        if isinstance(classname, list):\n            classList.remove(*classname)\n        else:\n            classList.remove(classname)\n        return self\n\n    def add_class(self, classname):\n        classList = self._js.classList\n        if isinstance(classname, list):\n            classList.add(*classname)\n        else:\n            self._js.classList.add(classname)\n        return self\n\n    @property\n    def classes(self):\n        classes = self._js.classList.values()\n        return [x for x in classes]\n\n    def show_me(self):\n        self._js.scrollIntoView()\n\n    def when(self, event, handler):\n        document.when(event, selector=self)(handler)\n\n\nclass StyleProxy(dict):\n    def __init__(self, element: Element) -> None:\n        self._element = element\n\n    @cached_property\n    def _style(self):\n        return self._element._js.style\n\n    def __getitem__(self, key):\n        return self._style.getPropertyValue(key)\n\n    def __setitem__(self, key, value):\n        self._style.setProperty(key, value)\n\n    def remove(self, key):\n        self._style.removeProperty(key)\n\n    def set(self, **kws):\n        for k, v in kws.items():\n            self._element._js.style.setProperty(k, v)\n\n    # CSS Properties\n    # Reference: https://github.com/microsoft/TypeScript/blob/main/src/lib/dom.generated.d.ts#L3799C1-L5005C2\n    # Following prperties automatically generated from the above reference using\n    # tools/codegen_css_proxy.py\n    @property\n    def visible(self):\n        return self._element._js.style.visibility\n\n    @visible.setter\n    def visible(self, value):\n        self._element._js.style.visibility = value\n\n\nclass StyleCollection:\n    def __init__(self, collection: "ElementCollection") -> None:\n        self._collection = collection\n\n    def __get__(self, obj, objtype=None):\n        return obj._get_attribute("style")\n\n    def __getitem__(self, key):\n        return self._collection._get_attribute("style")[key]\n\n    def __setitem__(self, key, value):\n        for element in self._collection._elements:\n            element.style[key] = value\n\n    def remove(self, key):\n        for element in self._collection._elements:\n            element.style.remove(key)\n\n\nclass ElementCollection:\n    def __init__(self, elements: [Element]) -> None:\n        self._elements = elements\n        self.style = StyleCollection(self)\n\n    def __getitem__(self, key):\n        # If it\'s an integer we use it to access the elements in the collection\n        if isinstance(key, int):\n            return self._elements[key]\n        # If it\'s a slice we use it to support slice operations over the elements\n        # in the collection\n        elif isinstance(key, slice):\n            return ElementCollection(self._elements[key])\n\n        # If it\'s anything else (basically a string) we use it as a selector\n        # TODO: Write tests!\n        elements = self._element.querySelectorAll(key)\n        return ElementCollection([Element(el) for el in elements])\n\n    def __len__(self):\n        return len(self._elements)\n\n    def __eq__(self, obj):\n        """Check if the element is the same as the other element by comparing\n        the underlying JS element"""\n        return isinstance(obj, ElementCollection) and obj._elements == self._elements\n\n    def _get_attribute(self, attr, index=None):\n        if index is None:\n            return [getattr(el, attr) for el in self._elements]\n\n        # As JQuery, when getting an attr, only return it for the first element\n        return getattr(self._elements[index], attr)\n\n    def _set_attribute(self, attr, value):\n        for el in self._elements:\n            setattr(el, attr, value)\n\n    @property\n    def html(self):\n        return self._get_attribute("html")\n\n    @html.setter\n    def html(self, value):\n        self._set_attribute("html", value)\n\n    @property\n    def children(self):\n        return self._elements\n\n    def __iter__(self):\n        yield from self._elements\n\n    def __repr__(self):\n        return f"{self.__class__.__name__} (length: {len(self._elements)}) {self._elements}"\n\n\nclass DomScope:\n    def __getattr__(self, __name: str) -> Any:\n        element = document[f"#{__name}"]\n        if element:\n            return element[0]\n\n\nclass PyDom(BaseElement):\n    # Add objects we want to expose to the DOM namespace since this class instance is being\n    # remapped as "the module" itself\n    BaseElement = BaseElement\n    Element = Element\n    ElementCollection = ElementCollection\n\n    def __init__(self):\n        super().__init__(document)\n        self.ids = DomScope()\n        self.body = Element(document.body)\n        self.head = Element(document.head)\n\n    def create(self, type_, parent=None, classes=None, html=None):\n        return super().create(type_, is_child=False)\n\n    def __getitem__(self, key):\n        if isinstance(key, int):\n            indices = range(*key.indices(len(self.list)))\n            return [self.list[i] for i in indices]\n\n        elements = self._js.querySelectorAll(key)\n        if not elements:\n            return None\n        return ElementCollection([Element(el) for el in elements])\n\n\ndom = PyDom()\n\nsys.modules[__name__] = dom\n'}}),sn.push("del _Path"),sn.push("\n");var an=sn.join("\n"),ln={error:()=>import("./error-e4fe78fd.js")};async function cn(e,t){let n;try{n=await fetch(e,t)}catch(t){const n=t;let r;throw r=e.startsWith("http")?`Fetching from URL ${e} failed with error '${n.message}'. Are your filename and path correct?`:'Polyscript: Access to local files\n        (using [[fetch]] configurations in &lt;py-config&gt;)\n        is not available when directly opening a HTML file;\n        you must use a webserver to serve the additional files.\n        See <a style="text-decoration: underline;" href="https://github.com/pyscript/pyscript/issues/257#issuecomment-1119595062">this reference</a>\n        on starting a simple webserver with Python.\n            ',new tn(Qt,r)}if(!n.ok){const t=`Fetching from URL ${e} failed with error ${n.status} (${n.statusText}). Are your filename and path correct?`;switch(n.status){case 404:throw new tn(Gt,t);case 401:throw new tn(Xt,t);case 403:throw new tn(Kt,t);case 500:throw new tn(Vt,t);case 503:throw new tn(Zt,t);default:throw new tn(Qt,t)}}return n}const un=async e=>{let t=e?.trim(),n="",r=!1,s=/^{/.test(t)&&/}$/.test(t);if(!s&&/\.(\w+)(?:\?\S*)?$/.test(t)){const e=RegExp.$1;"json"===e&&"toml"!==hn?s=!0:"toml"===e&&"json"!==hn?r=!0:((e,t="")=>{let n=`(${Yt}): Invalid URL: ${e}`;throw t&&(n+=`\nexpected ${t} content`),new Error(n)})(t,hn),n=t,t=(await cn(n).then(Ae)).trim()}return{json:s,toml:r||!s&&!!t,text:t,url:n}},fn=(e,t,{message:n})=>{let r=`(${Yt}): Invalid ${e}`;return t&&(r+=` @ ${t}`),new SyntaxError(`${r}\n${n}`)};let pn,dn,mn,yn,hn,gn=e("py-config");if(gn?(pn=gn.getAttribute("src")||gn.textContent,hn=gn.getAttribute("type")):(gn=e(['script[type="py"][config]:not([worker])',"py-script[config]:not([worker])"].join(",")),gn&&(pn=gn.getAttribute("config"))),pn)try{const{json:e,toml:t,text:n,url:r}=await un(pn);if(pn=n,e||"json"===hn)try{mn=JSON.parse(n)}catch(e){yn=fn("JSON",r,e)}else if(t||"toml"===hn)try{const{parse:e}=await import("https://cdn.jsdelivr.net/npm/@webreflection/toml-j0.4/toml.js");mn=e(n)}catch(e){yn=fn("TOML",r,e)}}catch(e){yn=e}const wn=[];for(const[e,t]of Object.entries(ln))yn?"error"===e&&t().then((({notify:e})=>e(yn.message))):mn?.plugins?.includes(`!${e}`)||wn.push(t());wn.length&&(dn=Promise.all(wn))
/*! (c) PyScript Development Team */;const{assign:_n,defineProperty:bn}=Object;let vn;const En=new Map([["py","pyodide"],["mpy","micropython"]]),jn=({tagName:e})=>"SCRIPT"===e,kn=e=>{bn(document,"currentScript",{configurable:!0,get:()=>e})},Sn=()=>{delete document.currentScript},An=(e,t,n,r)=>{n(t);for(const n of $n[r])n(e,t)};let Pn=!0;const xn=({XWorker:e,interpreter:t,io:n})=>{t.registerJsModule("_pyscript",{PyWorker:function(...t){const r=e(...t);return r.onerror=({error:e})=>n.stderr(e),r},get target(){return jn(vn)?vn.target.id:vn.id}}),t.runPython(an,{globals:t.runPython("{}")})},$n={onBeforeRun:new Set,onBeforeRunAsync:new Set,onAfterRun:new Set,onAfterRunAsync:new Set,onInterpreterReady:new Set,codeBeforeRunWorker:new Set,codeBeforeRunWorkerAsync:new Set,codeAfterRunWorker:new Set,codeAfterRunWorkerAsync:new Set},Rn={codeBeforeRunWorker:()=>[an,...$n.codeBeforeRunWorker].map(xe).join("\n"),codeBeforeRunWorkerAsync:()=>[an,...$n.codeBeforeRunWorkerAsync].map(xe).join("\n"),codeAfterRunWorker:()=>[...$n.codeAfterRunWorker].map(xe).join("\n"),codeAfterRunWorkerAsync:()=>[...$n.codeAfterRunWorkerAsync].map(xe).join("\n")};for(const[e,t]of En){let n=0;const r=(t=e)=>`${t}-${n++}`,s=async(t,n,r)=>{if(t.hasAttribute("src"))try{return await cn(t.getAttribute("src")).then(Ae)}catch(e){n.stderr(e)}return r?xe(t.textContent):(console.warn(`Deprecated: use <script type="${e}"> for an always safe content parsing:\n`,t.innerHTML),xe(t.innerHTML))};if(!yn){const n=new Map;Lt(e,{config:mn,interpreter:t,env:`${e}-script`,onerror(e,t){n.set(t,e)},...Rn,onWorkerReady(e,t){_n(t.sync,nn)},onBeforeRun(e,t){vn=t,An(e,t,kn,"onBeforeRun")},onBeforeRunAsync(e,t){vn=t,An(e,t,kn,"onBeforeRunAsync")},onAfterRun(e,t){An(e,t,Sn,"onAfterRun")},onAfterRunAsync(e,t){An(e,t,Sn,"onAfterRunAsync")},async onInterpreterReady(t,o){Pn&&(Pn=!1,xn(t)),dn&&await dn;for(const e of $n.onInterpreterReady)e(t,o);if(n.has(o)){let{message:e}=n.get(o);n.delete(o);const r=e===bt;return e=`(${zt}) ${e} for `,e+=o.cloneNode(r).outerHTML,void t.io.stderr(e)}if(jn(o)){const{attributes:{async:n,target:a}}=o,i=!!a?.value,l=i?Et(a.value):document.createElement("script-py");if(!i){const{head:e,body:t}=document;e.contains(o)?t.append(l):o.after(l)}l.id||(l.id=r()),bn(o,"target",{value:l}),Be(o,e),t["run"+(n?"Async":"")](await s(o,t.io,!0))}else o._wrap.resolve(t);console.debug("[pyscript/main] PyScript Ready")}})}class o extends HTMLElement{constructor(){_n(super(),{_wrap:Promise.withResolvers(),srcCode:"",executed:!1})}get _pyodide(){return this._wrap}get id(){return super.id||(super.id=r())}set id(e){super.id=e}async connectedCallback(){if(!this.executed){this.executed=!0;const{io:t,run:n,runAsync:r}=await this._wrap.promise,o=this.hasAttribute("async")?r:n;this.srcCode=await s(this,t,!this.childElementCount),this.replaceChildren(),Be(this,e),o(this.srcCode),this.style.display="block"}}}yn||customElements.define(`${e}-script`,o)}function Tn(e,t){const n=Jt.call(new wt(null,Rn),e,{...t,type:"pyodide"});return _n(n.sync,nn),n}export{Tn as PyWorker,$n as hooks};
//# sourceMappingURL=core.js.map
